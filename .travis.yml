language: php

php:
  - 5.4

before_install:
  - composer self-update
  - composer install --dev -n --prefer-source

before_script:
  - gem install mailcatcher
  - phpenv config-add travis.php.ini
  - mailcatcher
  - mkdir -p resources/logs resources/tmp

script:
  - phpunit

after_script:
  - CODECLIMATE_REPO_TOKEN="9d650adf32ba072b00e33e49abf052de9de09bb83c1d9569767c3da20c776696" bin/test-reporter --stdout > codeclimate.json
  - curl -X POST -d @codeclimate.json -H 'Content-Type: application/json' -H 'User-Agent: Code Climate (PHP Test Reporter v0.1.1)' https://codeclimate.com/test_reports
